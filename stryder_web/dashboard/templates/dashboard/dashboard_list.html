{% extends "base.html" %}

{% block title %}Dashboard · Stryder Web{% endblock %}

{% block content %}
  <h2>Runs - Summary</h2>

  <div class="search_bar">
    <form method="get">
      <label>Keyword:
        <input type="text" name="key" placeholder="Search by workout name…" value="{{ key }}" />
      </label>
      <label>From:
        <input type="date" name="start" value="{{ start }}">
      </label>
      <label>To:
        <input type="date" name="end" value="{{ end }}">
      </label>
      <button type="submit">Search</button>
    </form>
  </div>

  <div class="summary_table">
    <table>
      <thead>
        <tr>
          <th>Number<br>of Runs</th>
          <th>Total<br>Distance</th>
          <th>Total<br>Duration</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>{{ summary.runs }}</td>
          <td>{{ summary.distance }}</td>
          <td>{{ summary.duration }}</td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="runs_table">
    <table>
      <thead>
        <tr>
          <th>Date</th>
          <th>Name</th>
          <th>Distance (km)</th>
          <th>Duration</th>
          <th>Avg Power</th>
          <th>Avg HR</th>
          <th>Workout type</th>
        </tr>
      </thead>
      <tbody>
        {% for run in page_obj %}
          <tr>
            <td>{{ run.dt }}</td>
            <td>
              <a href="{% url 'dashboard_detail' run_id=run.run_id %}">
                {{ run.wt_name }}
              </a>
            </td>
            <td>{{ run.distance }}</td>
            <td>{{ run.duration }}</td>
            <td>{{ run.avg_power }}</td>
            <td>{{ run.avg_hr }}</td>
            <td>{{ run.wt_type }}</td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>

  <div class="paginator">
    {% if page_obj.has_previous %}
      <a href="?key={{ key }}&start={{ start }}&end={{ end }}&sort={{ sort }}&page={{ page_obj.previous_page_number }}">← Prev</a>
    {% endif %}
    <span>Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}</span>
    {% if page_obj.has_next %}
      <a href="?key={{ key }}&start={{ start }}&end={{ end }}&sort={{ sort }}&page={{ page_obj.next_page_number }}">Next →</a>
    {% endif %}
  </div>

{% endblock %}
